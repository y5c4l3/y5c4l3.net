<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta property="og:url" content="https://y5c4l3.net/zh-cn/2023/08/19/recovering-rsa-key-pair-with-cado-nfs/">
  <meta property="og:site_name" content="Y5C4L3">
  <meta property="og:title" content="åˆ†å¸ƒå¼ CADO-NFS è¿˜åŸ RSA-512 å¯†é’¥">
  <meta property="og:description" content="ç®€ä»‹ RSA æ˜¯ç›®å‰å…¨ä¸–ç•Œä½¿ç”¨æœ€å¹¿æ³›çš„å…¬é’¥å¯†ç ä½“ç³». å…¬é’¥å¯†ç ä½“ç³»ä¸­ï¼Œæœ‰ä¸¤ç±»å¯†é’¥ï¼šç§é’¥ä¸å…¬é’¥. ç§é’¥æ˜¯ç”±ç®—æ³•ç”Ÿæˆçš„ï¼Œå¹¶ç”±æ“ä½œè€…å¦¥å–„ä¿ç®¡. å…¬é’¥æ˜¯ä»ç§é’¥æ¨å¯¼è€Œå‡ºçš„ï¼Œå¯ä»¥å…¬å¼€å‘å¸ƒç»™ä»»ä½•äºº. å…¬é’¥åŠå…¶å¯¹åº”çš„ç§é’¥ä¸ºä¸€å¯¹å¯†é’¥.
RSA å¯†é’¥çš„å¤§å°æŒ‡çš„æ˜¯ RSA åŠ å¯†æˆ–è§£å¯†è¿ç®—ä¸­æ¨¡çš„é•¿åº¦ï¼ˆæŒ‰ bit è®¡ç®—ï¼‰ï¼Œå®ƒå†³å®šäº†å¯†é’¥çš„æ•´ä½“å®‰å…¨æ€§. æˆªè‡³ 2023 å¹´ 8 æœˆï¼Œæ¨èçš„æœ€å°æ¨¡é•¿ä¸º 2048 ä½. ä¸è¿‡æ€»æœ‰å¼€å‘è€…ç½”é¡¾å®‰å…¨æ€§æœ€ä½³å®è·µï¼Œä»ç„¶åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨ 512 ä½ RSA å¯†é’¥.
æœ¬æ–‡å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ CADO-NFS å°† RSA-512 çš„å…¬é’¥æ¢å¤æˆ PKCS#1 / PKCS#8 æ ¼å¼çš„ç§é’¥.
å…è´£å£°æ˜: æœ¬æ–‡ä»…ä¾›æ•™è‚²ç›®çš„ï¼Œä½œè€…ä¸æ”¯æŒæˆ–é¼“åŠ±ä»»ä½•éæ³•æ´»åŠ¨. æœ¬æ–‡æä¾›çš„ä¿¡æ¯ä»…ä¾›å‚è€ƒï¼Œä¸åº”ç”¨äºä»»ä½•éæ³•æ´»åŠ¨. ä½œè€…ä¸å¯¹æ»¥ç”¨æœ¬æ–‡æä¾›çš„ä¿¡æ¯æ‰€é€ æˆçš„åæœè´Ÿè´£.
RSA å°å¤ä¹  å½¢å¼åŒ–è¡¨è¿° é€‰æ‹©ä¸¤ä¸ªç´ æ•° $p, q$ å°† $N:=pq$ ä½œä¸ºå¯†é’¥çš„æ¨¡.
è®¡ç®— $\lambda(N)=\lambda(pq)=\operatorname{lcm}(p-1,q-1)$.
è¿™é‡Œ $\lambda(n)$ is Carmichael å‡½æ•°, å®šä¹‰è§ $\eqref{carmichael}$.
$$ \begin{equation} \lambda(n):=\min\{m&gt;0: \forall a \in{}\mathbf{R}^*_n, a^m\equiv 1\pmod n\}\label{carmichael} \end{equation} $$
å…¶ä¸­ $\mathbf{R}^*_{n}{}:= \{i\in{}\mathbf{R}_n: \gcd(n, i) = 1\}$ æ˜¯æ¨¡ $n$ çš„ç®€åŒ–å‰©ä½™ç³».">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2023-08-19T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-08-19T00:00:00+00:00">
    <meta property="article:tag" content="å¯†ç å­¦">
    <meta property="article:tag" content="Rsa">
    <meta property="article:tag" content="Cado-Nfs">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="åˆ†å¸ƒå¼ CADO-NFS è¿˜åŸ RSA-512 å¯†é’¥">
  <meta name="twitter:description" content="ç®€ä»‹ RSA æ˜¯ç›®å‰å…¨ä¸–ç•Œä½¿ç”¨æœ€å¹¿æ³›çš„å…¬é’¥å¯†ç ä½“ç³». å…¬é’¥å¯†ç ä½“ç³»ä¸­ï¼Œæœ‰ä¸¤ç±»å¯†é’¥ï¼šç§é’¥ä¸å…¬é’¥. ç§é’¥æ˜¯ç”±ç®—æ³•ç”Ÿæˆçš„ï¼Œå¹¶ç”±æ“ä½œè€…å¦¥å–„ä¿ç®¡. å…¬é’¥æ˜¯ä»ç§é’¥æ¨å¯¼è€Œå‡ºçš„ï¼Œå¯ä»¥å…¬å¼€å‘å¸ƒç»™ä»»ä½•äºº. å…¬é’¥åŠå…¶å¯¹åº”çš„ç§é’¥ä¸ºä¸€å¯¹å¯†é’¥.
RSA å¯†é’¥çš„å¤§å°æŒ‡çš„æ˜¯ RSA åŠ å¯†æˆ–è§£å¯†è¿ç®—ä¸­æ¨¡çš„é•¿åº¦ï¼ˆæŒ‰ bit è®¡ç®—ï¼‰ï¼Œå®ƒå†³å®šäº†å¯†é’¥çš„æ•´ä½“å®‰å…¨æ€§. æˆªè‡³ 2023 å¹´ 8 æœˆï¼Œæ¨èçš„æœ€å°æ¨¡é•¿ä¸º 2048 ä½. ä¸è¿‡æ€»æœ‰å¼€å‘è€…ç½”é¡¾å®‰å…¨æ€§æœ€ä½³å®è·µï¼Œä»ç„¶åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨ 512 ä½ RSA å¯†é’¥.
æœ¬æ–‡å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ CADO-NFS å°† RSA-512 çš„å…¬é’¥æ¢å¤æˆ PKCS#1 / PKCS#8 æ ¼å¼çš„ç§é’¥.
å…è´£å£°æ˜: æœ¬æ–‡ä»…ä¾›æ•™è‚²ç›®çš„ï¼Œä½œè€…ä¸æ”¯æŒæˆ–é¼“åŠ±ä»»ä½•éæ³•æ´»åŠ¨. æœ¬æ–‡æä¾›çš„ä¿¡æ¯ä»…ä¾›å‚è€ƒï¼Œä¸åº”ç”¨äºä»»ä½•éæ³•æ´»åŠ¨. ä½œè€…ä¸å¯¹æ»¥ç”¨æœ¬æ–‡æä¾›çš„ä¿¡æ¯æ‰€é€ æˆçš„åæœè´Ÿè´£.
RSA å°å¤ä¹  å½¢å¼åŒ–è¡¨è¿° é€‰æ‹©ä¸¤ä¸ªç´ æ•° $p, q$ å°† $N:=pq$ ä½œä¸ºå¯†é’¥çš„æ¨¡.
è®¡ç®— $\lambda(N)=\lambda(pq)=\operatorname{lcm}(p-1,q-1)$.
è¿™é‡Œ $\lambda(n)$ is Carmichael å‡½æ•°, å®šä¹‰è§ $\eqref{carmichael}$.
$$ \begin{equation} \lambda(n):=\min\{m&gt;0: \forall a \in{}\mathbf{R}^*_n, a^m\equiv 1\pmod n\}\label{carmichael} \end{equation} $$
å…¶ä¸­ $\mathbf{R}^*_{n}{}:= \{i\in{}\mathbf{R}_n: \gcd(n, i) = 1\}$ æ˜¯æ¨¡ $n$ çš„ç®€åŒ–å‰©ä½™ç³».">

  
  


  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#262d33">
  <title>
    
    Y5C4L3 - åˆ†å¸ƒå¼ CADO-NFS è¿˜åŸ RSA-512 å¯†é’¥
    
  </title>
  
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  
  
  
  <link rel="stylesheet" href="/minima.1719054161.css">
  
  
  <script defer type="text/javascript" src="/minima.1719054161.js"></script>
  
	
	<link rel="alternate" hreflang="en" href="https://y5c4l3.net/2023/08/19/recovering-rsa-key-pair-with-cado-nfs/" title="EN">
	

</head>
<script>
  
  let default_theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';

  try {
    const local = localStorage.getItem('theme')
    if (local) {
      default_theme = local
    }
    localStorage.setItem('theme', default_theme);
    window.minima_theme = default_theme;
    document.querySelector('html').classList.add(default_theme);
  } catch (e) {
    console.error(e);
  }
</script>



<body>
  <header class="mt-3 mb-6">
  <div class="container mx-auto">
    <nav class="flex justify-between items-center">
      <div class="flex items-center">
        
        <div id="theme-switch" class="text-3xl cursor-pointer">ğŸŒ</div>
      </div>
      <ul class="flex items-center font-medium
        whitespace-nowrap overflow-x-auto overflow-y-hidden">
        
        <li class="ml-1 mr-1"><a href="/zh-cn/">é¦–é¡µ</a></li>
        
        <li class="ml-1 mr-1"><a href="/zh-cn/about">å…³äº</a></li>
        
        <li class="ml-1 mr-1"><a href="/zh-cn/archive">å½’æ¡£</a></li>
        
        <li class="ml-1 mr-1"><a href="/zh-cn/tags">æ ‡ç­¾</a></li>
        
        <li class="ml-1 mr-1"><a href="/zh-cn/series">ç³»åˆ—</a></li>
        
        <li class="ml-1 mr-1"><a href="/zh-cn/writing-guidelines">å¯¼åˆ™</a></li>
        
      </ul>
      <ul class="flex item-center text-sm font-bold">
        
        <li class="ml-2"><a href="https://y5c4l3.net/">EN</a></li>
        
        <li class="ml-2"><a href="https://y5c4l3.net/zh-cn/">ZH</a></li>
        
      </ul>
    </nav>
  </div>
</header>

  
<div class="container mx-auto">
  <h1 class="text-4xl font-extrabold mt-6 mb-6">åˆ†å¸ƒå¼ CADO-NFS è¿˜åŸ RSA-512 å¯†é’¥</h1>
  <div class="mb-3 text-sm flex justify-between ">
    <div>
      
      å‘å¸ƒäº &mdash; 2023 å¹´ 8 æœˆ 19 æ—¥
      
      
    </div>
    
    <div>
      
      
      <a class="ml-1" href="/zh-cn/tags/%e5%af%86%e7%a0%81%e5%ad%a6">#å¯†ç å­¦</a>
      
      
      <a class="ml-1" href="/zh-cn/tags/rsa">#rsa</a>
      
      
      <a class="ml-1" href="/zh-cn/tags/cado-nfs">#cado-nfs</a>
      
    </div>
    
  </div>
  <main class="mb-8">
    <p></p>
    <article class="md">
      <h1 id="ç®€ä»‹">ç®€ä»‹</h1>
<p><abbr title="Rivestâ€“Shamirâ€“Adleman">RSA</abbr> æ˜¯ç›®å‰å…¨ä¸–ç•Œä½¿ç”¨æœ€å¹¿æ³›çš„å…¬é’¥å¯†ç ä½“ç³». å…¬é’¥å¯†ç ä½“ç³»ä¸­ï¼Œæœ‰ä¸¤ç±»å¯†é’¥ï¼šç§é’¥ä¸å…¬é’¥. ç§é’¥æ˜¯ç”±ç®—æ³•ç”Ÿæˆçš„ï¼Œå¹¶ç”±æ“ä½œè€…å¦¥å–„ä¿ç®¡. å…¬é’¥æ˜¯ä»ç§é’¥æ¨å¯¼è€Œå‡ºçš„ï¼Œå¯ä»¥å…¬å¼€å‘å¸ƒç»™ä»»ä½•äºº. å…¬é’¥åŠå…¶å¯¹åº”çš„ç§é’¥ä¸ºä¸€å¯¹å¯†é’¥.</p>
<p>RSA å¯†é’¥çš„å¤§å°æŒ‡çš„æ˜¯ RSA åŠ å¯†æˆ–è§£å¯†è¿ç®—ä¸­æ¨¡çš„é•¿åº¦ï¼ˆæŒ‰ bit è®¡ç®—ï¼‰ï¼Œå®ƒå†³å®šäº†å¯†é’¥çš„æ•´ä½“å®‰å…¨æ€§. æˆªè‡³ 2023 å¹´ 8 æœˆï¼Œæ¨èçš„æœ€å°æ¨¡é•¿ä¸º 2048 ä½. ä¸è¿‡æ€»æœ‰å¼€å‘è€…ç½”é¡¾å®‰å…¨æ€§æœ€ä½³å®è·µï¼Œä»ç„¶åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨ 512 ä½ RSA å¯†é’¥.</p>
<p>æœ¬æ–‡å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ CADO-NFS å°† RSA-512 çš„å…¬é’¥æ¢å¤æˆ <abbr title="Public-Key Cryptography Standards">PKCS</abbr>#1 / PKCS#8 æ ¼å¼çš„ç§é’¥.</p>
<p><em><strong>å…è´£å£°æ˜</strong>: æœ¬æ–‡ä»…ä¾›æ•™è‚²ç›®çš„ï¼Œä½œè€…ä¸æ”¯æŒæˆ–é¼“åŠ±ä»»ä½•éæ³•æ´»åŠ¨. æœ¬æ–‡æä¾›çš„ä¿¡æ¯ä»…ä¾›å‚è€ƒï¼Œä¸åº”ç”¨äºä»»ä½•éæ³•æ´»åŠ¨. ä½œè€…ä¸å¯¹æ»¥ç”¨æœ¬æ–‡æä¾›çš„ä¿¡æ¯æ‰€é€ æˆçš„åæœè´Ÿè´£.</em></p>
<h1 id="rsa-å°å¤ä¹ ">RSA å°å¤ä¹ </h1>
<h2 id="å½¢å¼åŒ–è¡¨è¿°">å½¢å¼åŒ–è¡¨è¿°</h2>
<ul>
<li>
<p>é€‰æ‹©ä¸¤ä¸ªç´ æ•° $p, q$ å°† $N:=pq$ ä½œä¸ºå¯†é’¥çš„æ¨¡.</p>
</li>
<li>
<p>è®¡ç®— $\lambda(N)=\lambda(pq)=\operatorname{lcm}(p-1,q-1)$.</p>
<p>è¿™é‡Œ $\lambda(n)$ is <a href="https://en.wikipedia.org/wiki/Carmichael_function">Carmichael å‡½æ•°</a>, å®šä¹‰è§ $\eqref{carmichael}$.</p>
<p>$$
\begin{equation}
\lambda(n):=\min\{m&gt;0: \forall a \in{}\mathbf{R}^*_n, a^m\equiv 1\pmod n\}\label{carmichael}
\end{equation}
$$</p>
<p>å…¶ä¸­ $\mathbf{R}^*_{n}{}:= \{i\in{}\mathbf{R}_n: \gcd(n, i) = 1\}$ æ˜¯æ¨¡ $n$ çš„ç®€åŒ–å‰©ä½™ç³».</p>
<p>è®¸å¤šæ•™ç§‘ä¹¦ä½¿ç”¨çš„æ˜¯ <a href="https://en.wikipedia.org/wiki/Euler%27s_totient_function">Euler å‡½æ•°</a> $\varphi(n)$ï¼Œè¿™ä¸å½±å“ç®—æ³•çš„æ­£ç¡®æ€§.</p>
</li>
<li>
<p>é€‰æ‹©ä¸€ä¸ªå…¬å¼€æŒ‡æ•° $e\neq 1$ ä½¿å¾— $e\in{}\mathbf{R}^*_{\lambda(n)}$ï¼Œå³ $e$ ä¸ $\lambda(n)$ äº’ç´ .</p>
</li>
<li>
<p>è®¡ç®—ç§æœ‰æŒ‡æ•° $d:\equiv e^{-1}\pmod{\lambda(n)}$.</p>
</li>
<li>
<p>å¯¹äºç«¯åˆ°ç«¯åŠ å¯†ï¼ŒåŠ å¯†æœºå®šä¹‰ä¸º $E(m):\equiv m^e\pmod N$ è€Œè§£å¯†æœºå®šä¹‰ä¸º $D(m):\equiv m^d\pmod N$.</p>
</li>
<li>
<p>ç­¾åæœºå®šä¹‰ä¸º $\DeclareMathOperator*{\concat}{\Vert} S(m):=D( \operatorname{hash}(m))$</p>
</li>
</ul>
<p>æ­¤å¤„å¹¶ä¸æ‰“ç®—ç»™å‡ºä»»ä½•å…³äº RSA æ­£ç¡®æ€§çš„è¯æ˜ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥é˜…è¯» William Stein åœ¨ä»–çš„è‘—ä½œ <em>Elementary Number Theory: Primes, Congruences, and Secrets</em> ä¸­çš„<a href="https://wstein.org/ent/ent.pdf">è¯æ˜</a>.</p>
<p>è¿™é‡Œçš„å½¢å¼åŒ–è¡¨è¿°æ¯”è¾ƒå­¦é™¢æ´¾ï¼Œç”Ÿæ´»ä¸­çš„ç®—æ³•å®ç°æœ‰æ›´å¤šè‹›åˆ»çš„å®‰å…¨æ¡ä»¶ï¼Œä¾‹å¦‚ $p,q$ é—´çš„è·ç¦»è¦é€‚åº¦, å…¬å¼€æŒ‡æ•°è‡³å°‘æ»¡è¶³ $e&gt;2$ çš„è¦æ±‚ï¼Œå¹¶ä¸”å¯†ç å­¦å‡½æ•°åº“å¾€å¾€ç”¨ $e:=65537$ è¿™ä¸€å›ºå®šå€¼ä½œä¸ºå…¬å¼€æŒ‡æ•°ï¼Œæ›´å¤šå®è·µå¯å‚è€ƒ<a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Security_and_practical_considerations">æ­¤å¤„</a>.</p>
<h2 id="ç°å®ä¸­çš„-rsa-æˆåˆ†">ç°å®ä¸­çš„ RSA æˆåˆ†</h2>
<p>ä»ä¸Šé¢çš„å½¢å¼åŒ–è¡¨è¿°ä¸­ï¼Œæ˜¾ç„¶ 3 å…ƒç»„ $(p, q, e)$ èƒ½å¤Ÿå”¯ä¸€åœ°å†³å®šä¸€å¯¹ RSA å¯†é’¥. ç†è®ºä¸Šï¼Œä¸€ä¸ª RSA ç§é’¥æˆåˆ†çš„è¡¨ç¤ºå¯ä»¥ç”¨ $(p, q, d)$ è€Œå…¶å¯¹åº”çš„å…¬é’¥æˆåˆ†å°±æ˜¯ $(N, e)=(pq, e)$. å½“ç„¶äº†ï¼Œä½¿ç”¨ $(p, q, e)$ ä¹Ÿèƒ½ä½œä¸º RSA ç§é’¥æˆåˆ†çš„ä¸€ç§è¡¨ç¤ºæ–¹å¼.</p>
<p>æ•°å­¦ä¸Šæ¥çœ‹ï¼Œç§é’¥çš„æˆåˆ†è¡¨ç¤ºæ–¹å¼å…¶å®å¹¶ä¸å”¯ä¸€ï¼Œé‚£ä¹ˆåœ¨ç°ä»£çš„ç§é’¥æ–‡ä»¶ä¸­ç©¶ç«Ÿå­˜å‚¨äº†ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿæ¢å¥è¯è¯´ï¼Œåœ¨ PKCS#1 / PKCS#8 è¿™äº›ç§é’¥æ ¼å¼ä¸­ï¼Œç©¶ç«Ÿå­˜å‚¨äº†ä»€ä¹ˆæ ·çš„æˆåˆ†ï¼Ÿäº‹å®ä¸Šç°ä»£ç§é’¥æ ¼å¼ä¸­ï¼Œ<strong>ä¸ºäº†æƒè¡¡ç®—æ³•çš„æ—¶ç©ºæ€§èƒ½ï¼Œå­˜å‚¨äº†æ›´å¤šçš„æˆåˆ†</strong>.</p>
<h3 id="ç§é’¥æˆåˆ†">ç§é’¥æˆåˆ†</h3>
<p>è®© OpenSSL ç»™æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ª RSA-512 ç§é’¥ï¼Œå¹¶åˆ—å‡ºå…¶æˆåˆ†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ openssl genrsa <span class="m">512</span> <span class="p">|</span> tee sample.key <span class="p">|</span> openssl pkey -noout -text
</span></span><span class="line"><span class="cl">Private-Key: <span class="o">(</span><span class="m">512</span> bit, <span class="m">2</span> primes<span class="o">)</span>
</span></span><span class="line"><span class="cl">modulus:
</span></span><span class="line"><span class="cl">    00:e8:b1:ea:27:bc:3a:a6:9f:53:48:24:9c:5a:9d:
</span></span><span class="line"><span class="cl">    9e:64:af:12:3e:ae:db:46:f0:4d:99:55:61:fd:c2:
</span></span><span class="line"><span class="cl">    c8:45:35:25:05:e6:7b:37:c0:cc:92:7a:45:c0:5b:
</span></span><span class="line"><span class="cl">    01:a3:4c:4e:87:5b:70:48:62:05:2a:6e:c2:3a:6a:
</span></span><span class="line"><span class="cl">    f0:07:92:61:ad
</span></span><span class="line"><span class="cl">publicExponent: <span class="m">65537</span> <span class="o">(</span>0x10001<span class="o">)</span>
</span></span><span class="line"><span class="cl">privateExponent:
</span></span><span class="line"><span class="cl">    00:ca:ec:5c:86:ca:5f:5b:6f:15:f1:93:fb:c6:0a:
</span></span><span class="line"><span class="cl">    2e:57:1f:55:89:d4:72:e5:2a:2a:81:cd:33:e7:58:
</span></span><span class="line"><span class="cl">    35:ce:23:20:af:2c:e6:fd:39:4e:2f:a6:be:23:23:
</span></span><span class="line"><span class="cl">    7f:e3:d2:f1:81:98:ef:48:91:a3:94:68:04:c6:a6:
</span></span><span class="line"><span class="cl">    d3:49:df:a8:01
</span></span><span class="line"><span class="cl">prime1:
</span></span><span class="line"><span class="cl">    00:f6:a8:8b:b4:cb:45:0f:d8:b9:6b:de:32:31:87:
</span></span><span class="line"><span class="cl">    c1:98:05:6d:d0:07:3d:c0:c0:8d:3d:5c:c1:1a:3a:
</span></span><span class="line"><span class="cl">    64:7d:45
</span></span><span class="line"><span class="cl">prime2:
</span></span><span class="line"><span class="cl">    00:f1:81:fc:ee:f1:5b:01:58:0c:0a:92:e2:fe:84:
</span></span><span class="line"><span class="cl">    17:f2:9d:f9:bb:e9:6a:4d:fd:77:56:37:32:76:68:
</span></span><span class="line"><span class="cl">    54:15:49
</span></span><span class="line"><span class="cl">exponent1:
</span></span><span class="line"><span class="cl">    00:c2:d9:14:3b:c6:d3:90:98:18:a9:c0:86:10:20:
</span></span><span class="line"><span class="cl">    78:eb:19:66:cd:0d:db:57:78:04:5a:f3:f9:cb:39:
</span></span><span class="line"><span class="cl">    53:86:ad
</span></span><span class="line"><span class="cl">exponent2:
</span></span><span class="line"><span class="cl">    32:ff:5e:f8:d9:f0:7c:ad:2a:05:c5:94:b7:68:0f:
</span></span><span class="line"><span class="cl">    62:85:27:6a:1d:d4:fb:d9:0d:2d:20:84:c0:6a:31:
</span></span><span class="line"><span class="cl">    6f:39
</span></span><span class="line"><span class="cl">coefficient:
</span></span><span class="line"><span class="cl">    00:bf:63:63:7b:71:73:ab:59:66:7d:2e:6f:eb:8a:
</span></span><span class="line"><span class="cl">    e3:88:a1:10:cb:db:5f:fb:d4:83:31:52:2d:97:6c:
</span></span><span class="line"><span class="cl">    38:29:50
</span></span></code></pre></td></tr></table>
</div>
</div><p>é»˜è®¤æƒ…å†µä¸‹ <code>openssl genrsa</code> ä¼šç”Ÿæˆ PKCS#8 çš„æ ¼å¼ï¼Œä¸Šé¢çš„ç§é’¥ä¸­åŒ…å«äº†ï¼š</p>
<ul>
<li><strong>modulus</strong> å¯¹åº”äº† RSA çš„æ¨¡ $N:=pq$</li>
<li><strong>publicExponent</strong> å¯¹åº”äº†å…¬å¼€æŒ‡æ•° $e$, OpenSSL åœ¨ç”Ÿæˆç§é’¥æ—¶æ€»ä½¿ç”¨å›ºå®šå€¼ $e:=65537$</li>
<li><strong>privateExponent</strong> å¯¹åº”äº†ç§æœ‰æŒ‡æ•° $d:\equiv e^{-1}\pmod{\lambda(n)}$</li>
<li><strong>prime1</strong> å’Œ <strong>prime2</strong> å¯¹åº”äº† $p$ å’Œ $q$</li>
</ul>
<p>é‚£ä¹ˆ <strong>exponent1</strong>, <strong>exponent2</strong>, <strong>coefficient</strong> ç©¶ç«Ÿæ˜¯ä»€ä¹ˆä¸œè¥¿?</p>
<h4 id="crt-æ”¹è¿›çš„å¿«é€Ÿå¹‚">CRT æ”¹è¿›çš„å¿«é€Ÿå¹‚</h4>
<p>å¯¹è§£å¯†æœº $D(m):\equiv m^d\pmod N$ ä¸ç­¾åæœº $S(m)$ ç”¨<a href="https://en.wikipedia.org/wiki/Chinese_remainder_theorem">ä¸­å›½å‰©ä½™å®šç†ï¼ˆ<abbr title="Chinese Remainder Theorem">CRT</abbr>ï¼‰</a>å˜æ¢åï¼Œä¼šå‡ºç°ä¸Šé¢é¢å¤–çš„æˆåˆ†ï¼Œè¿™æ˜¯ä¸€ç§èƒ½å¤ŸåŠ é€Ÿè§£å¯†ä¸ç­¾åè¿‡ç¨‹çš„å°æŠ€å·§ï¼Œæœ¬è´¨ä¸Šæ¥è¯´è¿™æ˜¯ä¸€ç§å¤§æ•°å¿«é€Ÿå¹‚ï¼ˆå–æ¨¡ï¼‰çš„ç®—æ³•ï¼Œå¯¹äºå¤§æ•°çš„ä¹˜æ³•ï¼Œæ— è®ºé‡‡ç”¨ä½•ç§ç®—æ³•ï¼ˆå¦‚ Karatsuba æˆ– FFT ç­‰ï¼‰ï¼Œå…¶æ—¶é—´å¤æ‚åº¦éƒ½ä¸å†èƒ½è§†ä½œ $O(1)$ï¼Œä¸€èˆ¬å¤§æ•°è¿ç®—éƒ½ä¼šç”±å¯†ç å­¦å‡½æ•°åº“æä¾›.</p>
<p>è®¡ç®— $m^d\pmod N$ ç­‰ä»·äºè§£æ–¹ç¨‹ $\eqref{crt-1}$ï¼Œæ˜¾ç„¶æœ‰è§£</p>
<p>$$
\begin{equation}
x\equiv m^d\pmod{pq}\label{crt-1}
\end{equation}
$$</p>
<p>ç”±äº $p,q$ æ˜¯ç´ æ•°ï¼Œå®ƒä»¬æ˜¾ç„¶äº’ç´ ï¼Œå³ $\gcd(p,q)=1$. æ ¹æ® CRT çš„è¡¨è¿°ï¼Œæ–¹ç¨‹ $\eqref{crt-1}$ èƒ½æ‹†å¼€å†™æˆæ–¹ç¨‹ç»„ $\eqref{crt-2}$ å¹¶æ‹¥æœ‰ç›¸åŒè§£é›†.</p>
<p>$$
\begin{equation}
\left\{
\begin{aligned}
x&amp;\equiv m^d\pmod{p} \\
x&amp;\equiv m^d\pmod{q}
\end{aligned}
\right.\label{crt-2}
\end{equation}
$$</p>
<p>é€šè¿‡è¿™æ ·åšï¼Œæ¨¡ $N:=pq$ åœ¨ä½æ•°ä¸Šå·²ç»è¢«åŠˆå¼€åˆ†æˆäº† $p,q$ï¼Œè‡ªç„¶åœ°ä¸º $d$ çš„é™å¹‚æä¾›äº†æœºä¼š.</p>
<p>å¯¹äºä¸€ä¸ªç´ æ•°ï¼Œå®ƒçš„ Carmichael å‡½æ•°å€¼ä¸ Euler å‡½æ•°å€¼ç›¸åŒï¼Œå³</p>
<p>$$
\lambda(p)=\varphi(p)=p-1,\lambda(q)=\varphi(q)=q-1
$$</p>
<p>ä»¤ $d_p:\equiv d\pmod{\lambda(p)}$ ä¸ $d_q:\equiv d\pmod{\lambda(q)}$ï¼Œå³å­˜åœ¨ $k_p,k_q\in\mathbb{Z}$ ä½¿å¾—</p>
<p>$$
d=k_p\lambda(p)+d_p=k_q\lambda(q)+d_q,
$$</p>
<p>é€šè¿‡åº”ç”¨ Euler å®šç†ï¼Œæ•´ç†å¾—åˆ°é™å¹‚å½¢å¼ $\eqref{crt-3}$ï¼Œ</p>
<p>$$
\begin{equation}
\left\{
\begin{aligned}
x&amp;\equiv m^d\equiv m^{k_p\lambda(p)+d_p}\equiv m^{d_p}\pmod{p} \\
x&amp;\equiv m^d\equiv m^{k_q\lambda(q)+d_q}\equiv m^{d_q}\pmod{q}
\end{aligned}
\right.\label{crt-3}
\end{equation}
$$</p>
<p>è¿™äº›æ›´å°çš„æŒ‡æ•° $d_p$ å’Œ $d_q$ åœ¨<a href="/zh-cn/2023/08/19/recovering-rsa-key-pair-with-cado-nfs/#ç§é’¥æˆåˆ†">ä¹‹å‰çš„æˆåˆ†åˆ—è¡¨</a>ä¸­å«åš <strong>exponent1</strong> å’Œ <strong>exponent2</strong>ï¼Œåœ¨ç”Ÿæˆç§é’¥æ—¶å®ƒä»¬å°±å·²ç»ç®—å¥½è¿™ä¸¤ä¸ªæˆåˆ†ï¼Œå¹¶å­˜å‚¨åœ¨ç§é’¥æ–‡ä»¶ä¸­.</p>
<p>æ ¹æ® CRT æ–¹ç¨‹ç»„çš„ç®—æ³•ï¼Œè§£ä¸º $\eqref{crt-4}$</p>
<p>$$
\begin{equation}
x\equiv m^{d_q} + q^*(m^{d_p}-m^{d_q})q \pmod{pq}\label{crt-4}
\end{equation}
$$</p>
<p>å…¶ä¸­ $q^*:\equiv q^{-1} \pmod p$ï¼Œåœ¨<a href="/zh-cn/2023/08/19/recovering-rsa-key-pair-with-cado-nfs/#ç§é’¥æˆåˆ†">ä¹‹å‰çš„æˆåˆ†åˆ—è¡¨</a>ä¸­å«åš <strong>coefficient</strong>.</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œé‚£äº›é¢å¤–çš„æˆåˆ†ä¸€èˆ¬å«åš CRT æˆåˆ†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ul>
<li><strong>exponent1</strong>ï¼ˆå¯¹åº” <strong>prime1</strong> $p$ï¼‰å®šä¹‰ä¸º $d_p:\equiv d\pmod{\lambda(p)}$, where $\lambda(p)=p-1$</li>
<li><strong>exponent2</strong>ï¼ˆå¯¹åº” <strong>prime2</strong> $q$ï¼‰å®šä¹‰ä¸º $d_q:\equiv d\pmod{\lambda(q)}$, where $\lambda(q)=q-1$</li>
<li><strong>coefficient</strong> å®šä¹‰ä¸º $q^*:\equiv q^{-1} \pmod p$</li>
</ul>
<h3 id="å…¬é’¥æˆåˆ†">å…¬é’¥æˆåˆ†</h3>
<p>ä½¿ç”¨ OpenSSL å°†ä¹‹å‰çš„ç§é’¥å¯¼å‡ºä¸ºå…¬é’¥ï¼Œå¹¶æŸ¥çœ‹å…¶æˆåˆ†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ openssl rsa -in sample.key -pubout <span class="p">|</span> openssl pkey -pubin -noout -text
</span></span><span class="line"><span class="cl">writing RSA key
</span></span><span class="line"><span class="cl">Public-Key: <span class="o">(</span><span class="m">512</span> bit<span class="o">)</span>
</span></span><span class="line"><span class="cl">Modulus:
</span></span><span class="line"><span class="cl">    00:e8:b1:ea:27:bc:3a:a6:9f:53:48:24:9c:5a:9d:
</span></span><span class="line"><span class="cl">    9e:64:af:12:3e:ae:db:46:f0:4d:99:55:61:fd:c2:
</span></span><span class="line"><span class="cl">    c8:45:35:25:05:e6:7b:37:c0:cc:92:7a:45:c0:5b:
</span></span><span class="line"><span class="cl">    01:a3:4c:4e:87:5b:70:48:62:05:2a:6e:c2:3a:6a:
</span></span><span class="line"><span class="cl">    f0:07:92:61:ad
</span></span><span class="line"><span class="cl">Exponent: <span class="m">65537</span> <span class="o">(</span>0x10001<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¬é’¥æˆåˆ†æ˜¯æ›´åŠ ç®€å•çš„ï¼Œæ°æ°å¥½å¥½æ˜¯ $(N,e)$.</p>
<h1 id="æ¢å¤å¯†é’¥">æ¢å¤å¯†é’¥</h1>
<p>RSA ä¸­çš„<a href="https://en.wikipedia.org/wiki/Trapdoor_function#RSA_Assumption">é™·é—¨</a>ä¿è¯äº†æ— æ³•è½»æ˜“ä»å…¬é’¥æ¢å¤å‡ºç§é’¥ï¼Œé™¤éçŸ¥é“äº† RSA æ¨¡çš„åˆ†è§£å¼å³ $N=pq$. åœ¨ç°æœ‰çš„åˆ†è§£æ•°æ®åº“ <a href="http://factordb.com/">factordb</a> ä¸Šå¯»æ‰¾ RSA æ¨¡çš„åˆ†è§£å¼æ˜¯ä¸€ä¸ªä¸é”™çš„æ–¹æ³•ï¼Œä½†åœ¨å¤§å¤šæ•°åœºåˆä¸‹å¾ˆéš¾å¥æ•ˆ.</p>
<p>è¦æ˜¯æœ‰äººä½¿ç”¨äº† RSA-512 çš„å¯†é’¥ï¼Œæ”»å‡»è€…åˆ©ç”¨ CADO-NFS å®ç°çš„ NFS ç®—æ³•<strong>ä¸èŠ±ä¸€ä¸ªæ˜ŸæœŸ</strong>å°±èƒ½æŠŠ RSA æ¨¡åˆ†è§£å‡ºæ¥.</p>
<h2 id="åˆ†å¸ƒå¼åˆ†è§£">åˆ†å¸ƒå¼åˆ†è§£</h2>
<p>CADO-NFS æ˜¯ä¸€ä¸ªå®Œå¤‡çš„è½¯ä»¶å¥—è£…ï¼Œå…¶ä¸­å°±åŒ…å«äº†ç”¨äºåˆ†å¸ƒå¼è®¡ç®—çš„ä¸­å¿ƒæœåŠ¡ç«¯ï¼Œè¿™é‡Œæ˜¯ä¸€äº›æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>
<p>æ— è®ºæ˜¯æœåŠ¡ç«¯è¿˜æ˜¯å®¢æˆ·ç«¯ï¼Œè¦å°½é‡ä½¿ç”¨ç›¸åŒçš„ Linux å‘è¡Œç‰ˆæˆ–è€… Docker é•œåƒ</p>
<p>ä¸ç„¶çš„è¯å¯èƒ½ä¼šé‡åˆ° <code>glibc</code> çš„ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜.</p>
</li>
<li>
<p>åœ¨å¯åŠ¨äº† CADO-NFS çš„æœåŠ¡ç«¯ä¹‹åï¼Œéœ€è¦ç•™æ„ä¼šè¾“å‡ºä¸€æ®µå¯ä¾›æ¢å¤åˆ†è§£è¿›åº¦çš„å‘½ä»¤ï¼Œå¦‚æœæœåŠ¡ç«¯æ„å¤–é€€å‡ºï¼Œå¯ä»¥ä½¿ç”¨è¯¥å‘½ä»¤æ¢å¤åˆ°é€€å‡ºå‰çš„è¿›åº¦.</p>
</li>
</ul>
<h3 id="å‰ç½®æ­¥éª¤">å‰ç½®æ­¥éª¤</h3>
<ul>
<li>
<p>ä¸ºäº†ç¼–è¯‘ CADO-NFSï¼Œé™¤äº†å¸¸ç”¨çš„å·¥å…·é“¾å¤–ï¼Œè¿˜è¦å®‰è£… <code>cmake</code> å’Œ <code>libgmp3-dev</code>.</p>
</li>
<li>
<p>ä¸‹è½½ CADO-NFS <a href="https://gitlab.inria.fr/cado-nfs/cado-nfs/-/archive/master/cado-nfs-master.tar.gz">æºä»£ç  tarball</a>åï¼Œ è§£å‹å¹¶è¿›å…¥ç›®å½•.</p>
</li>
<li>
<p>è¿è¡Œ <code>make -j8</code> å¼€å§‹æ„å»º. (å¯ä»¥æ ¹æ®æœºå™¨æƒ…å†µï¼Œè°ƒæ•´è¿™é‡Œçš„å¹¶å‘ä»»åŠ¡æ•°)</p>
</li>
<li>
<p>è¿™ä¸ªæ—¶å€™ <code>./cado-nfs.py</code> å’Œ <code>./cado-nfs-client.py</code> åº”è¯¥å¯ä»¥ç”¨äº†.</p>
</li>
<li>
<p>ä»å…¬é’¥æ–‡ä»¶ <code>pub.pem</code> è·å– RSA çš„æ¨¡ï¼Œä»æ­¤å¤„å¼€å§‹ä¸€äº›æ•°å­—æœ«å°¾è¢«æŠ¹æ‰äº†.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ openssl pkey -pubin -in pub.pem -noout -text
</span></span><span class="line"><span class="cl">Public-Key: <span class="o">(</span><span class="m">512</span> bit<span class="o">)</span>
</span></span><span class="line"><span class="cl">Modulus:
</span></span><span class="line"><span class="cl">    00:bc:dd:6e:bc:57:ae:a2:be:7d:ad:70:8f:71:0a:
</span></span><span class="line"><span class="cl">    80:86:3b:c5:18:f7:ab:4d:5e:bd:a5:64:b2:65:d2:
</span></span><span class="line"><span class="cl">    7c:d9:4c:5e:e3:c3:bc:33:b7:60:30:98:bd:6d:c4:
</span></span><span class="line"><span class="cl">    **:**:**:**:**:**:**:**:**:**:**:**:**:**:**:
</span></span><span class="line"><span class="cl">    **:**:**:**:**
</span></span><span class="line"><span class="cl">Exponent: <span class="m">65537</span> <span class="o">(</span>0x10001<span class="o">)</span>
</span></span><span class="line"><span class="cl">$ openssl rsa -pubin -in public.pem -noout -modulus 
</span></span><span class="line"><span class="cl"><span class="nv">Modulus</span><span class="o">=</span>BCDD6EBC57AEA2BE7DAD708F710A80863BC518F7AB4D5EBDA564B265D27CD94C5EE3C3BC33B7603098BD6DC4****************REDACTED****************
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¾—åˆ°äº†åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œéœ€è¦è½¬ä¸ºåè¿›åˆ¶ï¼Œä¾‹å¦‚å¯ä»¥ç›´æ¥è®© Python è¾“å‡ºæ•°å€¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python -c <span class="s2">&#34;print(0xBCDD6EBC57AEA2BE7DAD708F710A80863BC518F7AB4D5EBDA564B265D27CD94C5EE3C3BC33B7603098BD6DC4****************REDACTED****************)&#34;</span>
</span></span><span class="line"><span class="cl">9891661152720289911993780388856560399924301310754393756699908896661301299157403390541217712185535804***********************REDACTED***********************
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="æœåŠ¡ç«¯">æœåŠ¡ç«¯</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">./cado-nfs.py 9891661152720289911993780388856560399924301310754393756699908896661301299157403390541217712185535804***********************REDACTED*********************** <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>              server.ssl<span class="o">=</span>no server.address<span class="o">=</span>0.0.0.0 server.port<span class="o">=</span><span class="m">52600</span> server.whitelist<span class="o">=</span>0.0.0.0/0 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>              tasks.workdir<span class="o">=</span><span class="nv">$HOME</span>/nfs-work <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>              --server
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å®¢æˆ·ç«¯">å®¢æˆ·ç«¯</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">./cado-nfs-client.py --server<span class="o">=</span>http://server:52600 --override -t <span class="m">8</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å°†è¿™é‡Œçš„ <code>server</code> æ”¹æˆæœåŠ¡å™¨çš„åœ°å€ï¼Œæ¯å°æœºå™¨å¯è°ƒæ•´ <code>--override -t 8</code> çš„çº¿ç¨‹æ•°ï¼Œä»¥æé«˜åˆ†è§£è¿‡ç¨‹çš„å•æœºå¹¶è¡Œåº¦.</p>
<h3 id="ç»“æœ">ç»“æœ</h3>
<p>æœ€åçš„è¾“å‡ºä¾¿æ˜¯ä¸¤ä¸ªç´ æ•°ï¼Œå¯ä»¥çœ‹ä¸‹é¢çš„å›¾.</p>
<pre tabindex="0"><code>95488332303787905388806934005632272891519544646395*************************** 103590259815731432651796987187054092306262180182970***************************
</code></pre><center>
<figure><img src="/2023/08/19/recovering-rsa-key-pair-with-cado-nfs/factorization.png"><figcaption>
      <h4>åˆ†è§£ç»“æœ</h4>
    </figcaption>
</figure>

</center>
<h2 id="æ¢å¤ç§é’¥">æ¢å¤ç§é’¥</h2>
<p>ä¸ºäº†æ›´æ–¹ä¾¿åœ°åŸºäº $p, q, n, e$ åˆ›å»ºç§é’¥ï¼Œæ­¤å¤„æ¨è <a href="https://github.com/ius/rsatool"><code>rsatool.py</code></a> è¿™ä¸ªå·¥å…·ï¼Œä¸‹è½½å¯¹åº”ä»“åº“å¹¶è§£å‹åï¼Œåœ¨ç›®å½•ä¸­è¿è¡Œ <code>pip install .</code> å³å¯å®‰è£…ç›¸å…³ä¾èµ–.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python rsatool.py -n 9891661152720289911993780388856560399924301310754393756699908896661301299157403390541217712185535804***********************REDACTED*********************** <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>                    -p 95488332303787905388806934005632272891519544646395*************************** <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>                    -q 103590259815731432651796987187054092306262180182970*************************** <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>                    -e <span class="m">65537</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>                    -f PEM -o recovered.key
</span></span><span class="line"><span class="cl">Using <span class="o">(</span>p, q<span class="o">)</span> to calculate RSA paramaters
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">n</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">bcdd6ebc57aea2be7dad708f710a80863bc518f7ab4d5ebda564b265d27cd94c5ee3c3bc33b76030
</span></span><span class="line"><span class="cl">********************redacted********************
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">e</span> <span class="o">=</span> <span class="m">65537</span> <span class="o">(</span>0x10001<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">d</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">5d9b5a611b0c41392ccd23b6d48e21f965f26057909dbe513c825631454bffde921bc51a076cc3a5
</span></span><span class="line"><span class="cl">********************redacted********************
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">p</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">d31c7b17003dec91c9709546264c76c94670a4a9********redacted********
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">q</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">e506026099230459a9a042fac22b258da1c43647********redacted********
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Saving PEM as recovered.key
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¾¿å¾—åˆ°äº†æ¢å¤çš„ç§é’¥ <code>recovered.key</code>ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¯¥å·¥å…·ç”Ÿæˆçš„ç§é’¥æ ¼å¼ä¸º PKCS#1ï¼Œå¯ä»¥è½¬æ¢æˆ PKCS#8 æ ¼å¼ï¼Œåªéœ€è¿è¡Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ openssl pkey -in recovered.key
</span></span></code></pre></td></tr></table>
</div>
</div><!-- # é™„å½•ï¼šCarmichael vs. Euler -->

    </article>
  </main>
  

<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3.0.0/es5/tex-mml-chtml.js">
</script>
<script>
    MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            tags: 'ams',
        }
    };
</script>







<div id="comment"></div>










<div id="disqus_thread" class="mt-8 mb-8"></div>
<script type="text/javascript">
    
    
    if (window.location.hostname == "localhost") {
        
        
    } else {
        const dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;

        const disqus_shortname = 'y5c4l3';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        document.getElementById("comment").appendChild(dsq);
    }
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by
        Disqus.</a></noscript>



</div>


  <footer class="mt-8 mb-8">
  <div class="container mx-auto">
    <div class="mt-8 flex justify-between items-center">
      <p class="mt-0 text-sm">
        Â© 2024 y5c4l3 |
        <a href="https://gohugo.io" target="_blank" rel="noopener noreferrer">Hugo</a> on
        <a href="https://github.com/mivinci/hugo-theme-minima" target="_blank" rel="noopener noreferrer">Minima</a>
      </p>
      <p class="flex items-center mt-0">
        
          <a class="icon ml-1 mr-1" href="mailto:y5c4l3@proton.me" title="email">
          
            <svg fill="#63636f" width="22" height="22" viewBox="0 0 24 24"><path d="M3 3h18a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zm9.06 8.683L5.648 6.238L4.353 7.762l7.72 6.555l7.581-6.56l-1.308-1.513l-6.285 5.439z"/></svg>
          
          </a>
        
          <a class="icon ml-1 mr-1" href="https://github.com/y5c4l3" title="github">
          
            <svg fill="#63636f" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
          
          </a>
        
          <a class="icon ml-1 mr-1" href="/index.xml" title="rss">
          
            <svg fill="#63636f" t="1626591563876" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1984" width="18" height="16"><path d="M128 768a128 128 0 1 0 0 256 128 128 0 0 0 0-256zM0 368v176c265.104 0 480 214.912 480 480h176c0-362.32-293.696-656-656-656zM0 0v176c468.336 0 848 379.664 848 848h176C1024 458.464 565.536 0 0 0z" p-id="1985"></path></svg>
          
          </a>
        
      </p>
    </div>
  </div>
</footer>
</body>

</html>